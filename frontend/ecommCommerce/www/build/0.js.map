{"version":3,"sources":["../../src/pages/event-modal2/event-modal2.module.ts","../../node_modules/angular2-uuid/index.js","../../src/classes/appointment-class.ts","../../src/pages/event-modal2/event-modal2.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { EventModalPage2 } from './event-modal2';\n\n@NgModule({\n  declarations: [\n    EventModalPage2,\n  ],\n  imports: [\n    IonicPageModule.forChild(EventModalPage2),\n  ],\n})\nexport class EventModal2PageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/event-modal2/event-modal2.module.ts","\"use strict\";\nvar UUID = (function () {\n    function UUID() {\n        // no-op\n    }\n    UUID.UUID = function () {\n        if (typeof (window) !== \"undefined\" && typeof (window.crypto) !== \"undefined\" && typeof (window.crypto.getRandomValues) !== \"undefined\") {\n            // If we have a cryptographically secure PRNG, use that\n            // http://stackoverflow.com/questions/6906916/collisions-when-generating-uuids-in-javascript\n            var buf = new Uint16Array(8);\n            window.crypto.getRandomValues(buf);\n            return (this.pad4(buf[0]) + this.pad4(buf[1]) + \"-\" + this.pad4(buf[2]) + \"-\" + this.pad4(buf[3]) + \"-\" + this.pad4(buf[4]) + \"-\" + this.pad4(buf[5]) + this.pad4(buf[6]) + this.pad4(buf[7]));\n        }\n        else {\n            // Otherwise, just use Math.random\n            // https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\n            // https://stackoverflow.com/questions/11605068/why-does-jshint-argue-against-bitwise-operators-how-should-i-express-this-code\n            return this.random4() + this.random4() + \"-\" + this.random4() + \"-\" + this.random4() + \"-\" +\n                this.random4() + \"-\" + this.random4() + this.random4() + this.random4();\n        }\n    };\n    UUID.pad4 = function (num) {\n        var ret = num.toString(16);\n        while (ret.length < 4) {\n            ret = \"0\" + ret;\n        }\n        return ret;\n    };\n    UUID.random4 = function () {\n        return Math.floor((1 + Math.random()) * 0x10000)\n            .toString(16)\n            .substring(1);\n    };\n    return UUID;\n}());\nexports.UUID = UUID;\n//# sourceMappingURL=index.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/angular2-uuid/index.js\n// module id = 894\n// module chunks = 0 1","import {UUID} from \"angular2-uuid\";\n\nexport interface IAppointment {\n  _id: string,\n  idAppointment: string,\n  idSchedule: string\n  startTime: string,\n  endTime: string,\n  durationTime: number,\n  status: string,\n  client: string,\n  clientName: string,\n  professional: string,\n  service: string,\n  title: string\n};\n\nexport class AppointmentClass implements IAppointment {\n  constructor(public _id: string,\n              public idAppointment: string,\n              public idSchedule: string,\n              public startTime,\n              public endTime,\n              public durationTime: number,\n              public status: string,\n              public client: string,\n              public clientName: string,\n              public professional: string,\n              public service: string,\n              public title: string) {\n    this._id = _id;\n    this.idAppointment = idAppointment;\n    this.startTime = startTime;\n    this.endTime = endTime;\n    this.durationTime = durationTime;\n    this.status = status;\n    this.client = client;\n    this.clientName = clientName;\n    this.professional = professional;\n    this.service = service;\n    this.title = title;\n\n  }\n  eventColor: string;\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/classes/appointment-class.ts","import {Component, OnInit} from '@angular/core';\nimport {AlertController, IonicPage, NavController, NavParams, ViewController} from 'ionic-angular';\nimport * as moment from 'moment';\nimport { UUID } from 'angular2-uuid';\nimport { ServiceServiceProvider } from \"../../providers/service-service/service-service\";\nimport { IAppointment, AppointmentClass } from \"../../classes/appointment-class\";\nimport {CustomerClass} from \"../../classes/customer-class\";\nimport {Observable} from \"rxjs\";\nimport {map, filter} from \"rxjs/operators\";\nimport {observableToBeFn} from \"rxjs/testing/TestScheduler\";\nimport {ServiceClass} from \"../../classes/service-class\";\nimport {LoggedProfessional} from \"../../classes/logged-class\";\n\n@IonicPage()\n@Component({\n  selector: 'page-event-modal2',\n  templateUrl: 'event-modal2.html',\n})\nexport class EventModalPage2 implements OnInit {\n\n  eventColor = 'default';\n  servicesAvail = [];\n  servicesAvailAux$: Observable<any[]>;\n  customerSelected: CustomerClass;\n  eventSelected: '';\n  professional: LoggedProfessional;\n  events: AppointmentClass[] = [];\n\n  event: IAppointment;\n  prevEventImage: IAppointment = undefined;\n\n\n  minDate = new Date().toISOString();\n\n  constructor(public navCtrl: NavController, private navParams: NavParams, public viewCtrl: ViewController,\n              private servicesService: ServiceServiceProvider,\n              private alertCtrl: AlertController) {\n    this.customerSelected = this.navParams.get('customerSelected');\n    this.professional = this.navParams.get('professional');\n    this.events = this.navParams.get('events');\n    if (this.navParams.get('eventSelected')) {\n      this.event = this.navParams.get('eventSelected');\n      this.prevEventImage = Object.assign({}, this.event);\n      this.event.startTime =moment(this.event.startTime).format();\n      this.event.endTime = moment(this.event.endTime).format();\n    }\n    else {\n      let preselectedDate = moment(this.navParams.get('selectedDay')).format();\n      let thsService = this.navParams.get('service');\n      this.event = new AppointmentClass(null, UUID.UUID(), this.professional.idSchedule, preselectedDate, preselectedDate,null, null, this.customerSelected._id, this.customerSelected.name, this.professional.userId, thsService, null);\n      this.event.startTime = preselectedDate;\n      if (thsService !== undefined) {\n        this.event.service = thsService;\n        this.getServicesId(thsService).subscribe(data => {\n          this.event.endTime = moment(this.event.startTime).add(data[0].averageTime, 'm').format();\n          this.event.durationTime = data[0].averageTime;\n        });\n      }\n    }\n  }\n\n  validateSlotTime(currentEvent): boolean {\n    let auxEvent = this.events.filter( eventDate => {\n      return moment(currentEvent.startTime).toDate() >= eventDate.startTime && moment(currentEvent.endTime).toDate() >= eventDate.endTime && moment(currentEvent.startTime).toDate() <= eventDate.endTime\n    });\n    if (auxEvent.length > 0 ) {\n      return false\n    }\n    return true;\n\n  }\n\n  ngOnInit() {\n    console.log('Me volvi a disparar');\n    this.eventSelected = this.navParams.get('eventSelected');\n    this.getServices()\n  }\n\n  getServices() {\n    this.servicesService.getServices(this.professional.userId).subscribe(servicesAvail =>\n    {\n      this.servicesAvail = servicesAvail\n    });\n  }\n\n  getServicesId(id): Observable<ServiceClass[]> {\n    return this.servicesService.getServices(this.professional.userId).map(services => services.filter(result => result._id == id))\n  }\n\n  onServiceSelected() {\n    this.event.endTime = moment(this.event.startTime).add(this.servicesAvail.find(serviceAvail => serviceAvail._id == this.event.service).averageTime, 'm').format();\n    this.event.durationTime = this.servicesAvail.find(serviceAvail => serviceAvail._id == this.event.service).averageTime;\n  }\n\n  confirmAppnt(status) {\n    this.event.status = status;\n    this.viewCtrl.dismiss(this.event);\n  }\n\n  cancel() {\n    if (this.navParams.get('eventSelected')) {\n      this.event.service = this.prevEventImage.service;\n    }\n    this.viewCtrl.dismiss(this.prevEventImage);\n  }\n\n  save() {\n    if (this.event.service) {\n      this.event.title = this.servicesAvail.find(serviceAvail => serviceAvail._id == this.event.service).name + ': ' + this.event.clientName;\n      if (this.validateSlotTime(this.event)) {\n        this.viewCtrl.dismiss(this.event);\n      }\n      else {\n        let alert = this.alertCtrl.create({\n          title: 'Espacio Ocupado',\n          subTitle: 'El espacio seleccionado ya tiene una cita agendada: Presione Agendar para permitir la doble agenda o Deshacer para no ingresar la cita',\n          buttons: [{text: 'Deshacer'},\n            { text: 'Agendar',\n              handler: () => {\n                this.viewCtrl.dismiss(this.event);\n              }\n            }]\n        })\n        alert.present();\n      }\n    }\n    else {\n      this.eventColor = 'danger';\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/event-modal2/event-modal2.ts"],"sourceRoot":""}